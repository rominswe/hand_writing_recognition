# âœï¸ Handwriting Writer Identification

**CCS3113 â€“ Deep Learning Project**

## ğŸ“Œ Project Overview

This project focuses on **handwriting writer identification** using **deep learning**.
Given an image of handwritten text, the system predicts **which writer** produced it.

The task simulates a real-world forensic scenario where anonymous handwritten notes must be traced back to their authors. The solution is built using **Convolutional Neural Networks (CNNs)** and is designed to run **offline on a Windows CPU-only system**, as required by the course.

---

## ğŸ¯ Objective

* Train a deep learning model to **classify handwriting images by writer ID**
* Use **only neural networks** (no traditional machine learning)
* Ensure the system works **without GPU or internet**
* Provide a **fully automated testing script**
* Produce clear outputs (accuracy, CSV results, confusion matrix)

---

## ğŸ“‚ Dataset Description

The dataset is provided as part of the course materials

### Training Dataset (`train/`)

* Contains labeled handwriting images
* **Class label is extracted from the filename**
* Example:

  ```
  01_9_999.png
  ```

  * `01` â†’ Writer ID (converted to class index 0 internally)

### Test Dataset (`test/`)

* Structured exactly like training data
* Used **only for evaluation**
* No test images are used during training

### Hold-out Test Dataset

* Used for final performance evaluation
* Same structure as the test dataset

---

## ğŸ§  Model & Approach (High-Level)

The model architecture and image resolution are intentionally designed to ensure efficient inference on a CPU-only system.

1. **Preprocessing**

   * Convert images to grayscale
   * Slice long handwriting images vertically
   * Remove low-information slices using variance thresholding
   * Resize slices for CPU efficiency
   * Normalize pixel values

2. **Data Augmentation**

   * Small rotations, shifts, zooms, and shearing
   * Helps improve generalization without changing test data

3. **Model Architecture**

   * CNN with increasing filter depth
   * Batch Normalization for stable training
   * Dropout & L2 regularization to reduce overfitting
   * Global Average Pooling for efficiency
   * Softmax output for multi-class classification (70 writers)

4. **Training Strategy**

   * Label smoothing
   * Class weighting for balanced learning
   * Early stopping
   * Learning rate reduction
   * Best model saved automatically

---

## ğŸ“ Project Structure

```
.
â”œâ”€â”€ train.py
â”œâ”€â”€ run.py
â”œâ”€â”€ analyze.py
â”œâ”€â”€ requirements.txt
â”œâ”€â”€ README.md
â”œâ”€â”€ .gitignore
â”œâ”€â”€ train/
â”œâ”€â”€ test/
â”œâ”€â”€ analyze/
â”œâ”€â”€ model.keras
â”œâ”€â”€ labels.json
â”œâ”€â”€ result.csv
â””â”€â”€ doc/
```

---

## ğŸ“„ File-by-File Explanation

### `train.py` â€” Model Training Script

This script:

* Loads and preprocesses training images
* Extracts class labels from filenames
* Performs data slicing and augmentation
* Trains the CNN model
* Saves:

  * Trained model â†’ `model.keras`
  * Label mapping â†’ `labels.json`
  * Training curves â†’ `doc/training_plot.png`

**Purpose:**
ğŸ“Œ Build and train the handwriting recognition model.

---

### `run.py` â€” Deployment & Evaluation Script

This script:

* Runs on **CPU-only Windows system**
* Loads the trained model and label map
* Processes all test images
* Predicts the writer for each image
* Computes overall accuracy
* Saves:

  * Predictions â†’ `result.csv`
  * Confusion matrix â†’ `doc/writer_confusion_matrix.png`

**Purpose:**
ğŸ“Œ Evaluate the model on unseen test data and generate required outputs.

---

### `analyze.py` â€” Error & Performance Analysis

This script:

* Analyzes the confusion matrix
* Identifies:

  * Most confused writer pairs
  * Writers with lowest accuracy
* Saves detailed analysis CSV files in `analyze/`

**Purpose:**
ğŸ“Œ Understand model weaknesses and error patterns (optional analysis).

---

### `labels.json`

Maps numeric class IDs to readable writer names:

```json
{
  "01": "Writer 01",
  "02": "Writer 02",
  ...
}
```
This file is generated automatically during training.

**Purpose:**
ğŸ“Œ Human-readable class interpretation.

---

### `result.csv`

Generated by `run.py` and contains:

| filename | actual | predicted |
| -------- | ------ | --------- |

**Purpose:**
ğŸ“Œ Required submission output showing predictions.

---

### `requirements.txt`

Lists all Python packages and exact versions required to run the project **offline**.

**Purpose:**
ğŸ“Œ Ensures reproducibility on the evaluation machine.

---

### `doc/`

Contains project documentation as well as generated visual outputs:

* Training accuracy/loss plots
* Confusion matrix image

---

## â–¶ï¸ How to Run the Project

### 1ï¸âƒ£ Install Dependencies

```
pip install -r requirements.txt
```

### 2ï¸âƒ£ Train the Model

```
python train.py
```

### 3ï¸âƒ£ Evaluate on Test Data

```
python run.py
```

---

## ğŸ“Š Model Expectations & Limitations

* Optimized for **CPU-only inference**
* Accuracy depends on handwriting variability
* Some writers may have overlapping styles
* Model uses **probability voting** across image slices for stability

---

## âœ… Compliance with Project Rules

âœ” Uses **deep learning only**
âœ” No test data leakage
âœ” Runs offline on Windows CPU
âœ” Outputs required files
âœ” Script-based (not notebook-based)
âœ” Model saved as `model.keras`

---

## ğŸ‘¤ Author

**CCS3113 â€“ Deep Learning**
Handwriting Writer Identification Project
